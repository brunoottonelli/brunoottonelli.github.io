{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/bruno/Personal%20web%20page/src/lib/create-response.ts"],"sourcesContent":["/**\r\n * Creates a JSON success response with custom structure\r\n */\r\nexport function createSuccessResponse<T>(\r\n    data: T,\r\n    status: number = 200\r\n  ): Response {\r\n    return new Response(\r\n      JSON.stringify({\r\n        success: true,\r\n        data,\r\n      }),\r\n      {\r\n        status,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      }\r\n    );\r\n  }\r\n  \r\n  /**\r\n   * Creates a JSON error response with custom structure\r\n   */\r\n  export function createErrorResponse(params: {\r\n    errorCode?: string;\r\n    errorMessage: string;\r\n    status?: number;\r\n  }): Response {\r\n    const { errorCode, errorMessage, status = 500 } = params;\r\n    return new Response(\r\n      JSON.stringify({\r\n        success: false,\r\n        errorCode,\r\n        errorMessage,\r\n      }),\r\n      {\r\n        status,\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      }\r\n    );\r\n  }\r\n  "],"names":[],"mappings":"AAAA;;CAEC;;;;AACM,SAAS,sBACZ,IAAO,EACP,SAAiB,GAAG;IAEpB,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;QACb,SAAS;QACT;IACF,IACA;QACE;QACA,SAAS;YACP,gBAAgB;QAClB;IACF;AAEJ;AAKO,SAAS,oBAAoB,MAInC;IACC,MAAM,EAAE,SAAS,EAAE,YAAY,EAAE,SAAS,GAAG,EAAE,GAAG;IAClD,OAAO,IAAI,SACT,KAAK,SAAS,CAAC;QACb,SAAS;QACT;QACA;IACF,IACA;QACE;QACA,SAAS;YACP,gBAAgB;QAClB;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/bruno/Personal%20web%20page/src/lib/api-utils.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\r\nimport { createErrorResponse } from \"./create-response\";\r\n\r\n/**\r\n * Validates that required PostgREST environment variables are set\r\n */\r\nexport function validateEnv(): void {\r\n  const requiredVars = [\r\n    \"POSTGREST_URL\",\r\n    \"POSTGREST_SCHEMA\",\r\n    \"POSTGREST_API_KEY\",\r\n  ];\r\n  const missing = requiredVars.filter((varName) => !process.env[varName]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new Error(\r\n      `Missing required environment variables: ${missing.join(\", \")}`\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Parses common query parameters from a request URL\r\n */\r\nexport function parseQueryParams(request: NextRequest) {\r\n  const searchParams = request.nextUrl.searchParams;\r\n  return {\r\n    limit: parseInt(searchParams.get(\"limit\") || \"10\"),\r\n    offset: parseInt(searchParams.get(\"offset\") || \"0\"),\r\n    id: searchParams.get(\"id\"),\r\n    search: searchParams.get(\"search\"),\r\n  };\r\n}\r\n\r\n/**\r\n * Validates and parses JSON request body with error handling\r\n */\r\nexport async function validateRequestBody(request: NextRequest): Promise<any> {\r\n  try {\r\n    const body = await request.json();\r\n\r\n    if (!body || typeof body !== \"object\") {\r\n      throw new Error(\"Invalid request body\");\r\n    }\r\n\r\n    return body;\r\n  } catch (error) {\r\n    if (error instanceof SyntaxError) {\r\n      throw new Error(\"Invalid JSON in request body\");\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Higher-order function Verify token\r\n */\r\nexport function requestMiddleware(\r\n  handler: (request: NextRequest) => Promise<Response>\r\n) {\r\n  return async (request: NextRequest): Promise<Response> => {\r\n    try {\r\n      return await handler(request);\r\n    }\r\n    catch (error: unknown) {\r\n      // Pass through Response objects as-is\r\n      if (error instanceof Response) {\r\n        return error;\r\n      }\r\n\r\n      const anyError = error as any;\r\n      const errorMessage: string =\r\n        typeof anyError?.message === \"string\"\r\n          ? anyError.message\r\n          : \"Request failed\";\r\n      const status: number =\r\n        typeof anyError?.status === \"number\"\r\n          ? anyError.status\r\n          : typeof anyError?.statusCode === \"number\"\r\n          ? anyError.statusCode\r\n          : 500;\r\n      const errorCode: string | undefined =\r\n        typeof anyError?.code === \"string\" ? anyError.code : undefined;\r\n\r\n      return createErrorResponse({\r\n        errorCode,\r\n        errorMessage,\r\n        status,\r\n      });\r\n    }\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;AACA;;AAKO,SAAS;IACd,MAAM,eAAe;QACnB;QACA;QACA;KACD;IACD,MAAM,UAAU,aAAa,MAAM,CAAC,CAAC,UAAY,CAAC,QAAQ,GAAG,CAAC,QAAQ;IAEtE,IAAI,QAAQ,MAAM,GAAG,GAAG;QACtB,MAAM,IAAI,MACR,CAAC,wCAAwC,EAAE,QAAQ,IAAI,CAAC,OAAO;IAEnE;AACF;AAKO,SAAS,iBAAiB,OAAoB;IACnD,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,OAAO;QACL,OAAO,SAAS,aAAa,GAAG,CAAC,YAAY;QAC7C,QAAQ,SAAS,aAAa,GAAG,CAAC,aAAa;QAC/C,IAAI,aAAa,GAAG,CAAC;QACrB,QAAQ,aAAa,GAAG,CAAC;IAC3B;AACF;AAKO,eAAe,oBAAoB,OAAoB;IAC5D,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;YACrC,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,aAAa;YAChC,MAAM,IAAI,MAAM;QAClB;QACA,MAAM;IACR;AACF;AAKO,SAAS,kBACd,OAAoD;IAEpD,OAAO,OAAO;QACZ,IAAI;YACF,OAAO,MAAM,QAAQ;QACvB,EACA,OAAO,OAAgB;YACrB,sCAAsC;YACtC,IAAI,iBAAiB,UAAU;gBAC7B,OAAO;YACT;YAEA,MAAM,WAAW;YACjB,MAAM,eACJ,OAAO,UAAU,YAAY,WACzB,SAAS,OAAO,GAChB;YACN,MAAM,SACJ,OAAO,UAAU,WAAW,WACxB,SAAS,MAAM,GACf,OAAO,UAAU,eAAe,WAChC,SAAS,UAAU,GACnB;YACN,MAAM,YACJ,OAAO,UAAU,SAAS,WAAW,SAAS,IAAI,GAAG;YAEvD,OAAO,CAAA,GAAA,kIAAA,CAAA,sBAAmB,AAAD,EAAE;gBACzB;gBACA;gBACA;YACF;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///home/bruno/Personal%20web%20page/src/app/next_api/contact/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\nimport { createSuccessResponse, createErrorResponse } from '@/lib/create-response';\nimport { requestMiddleware, validateRequestBody } from '@/lib/api-utils';\n\n// POST request - send contact email\nexport const POST = requestMiddleware(async (request: NextRequest) => {\n  const body = await validateRequestBody(request);\n  \n  // Validate required fields\n  if (!body.email || !body.subject || !body.message) {\n    return createErrorResponse({\n      errorMessage: 'Email, subject, and message are required',\n      status: 400,\n    });\n  }\n\n  // Validate email format\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  if (!emailRegex.test(body.email)) {\n    return createErrorResponse({\n      errorMessage: 'Invalid email format',\n      status: 400,\n    });\n  }\n\n  try {\n    // Use Resend API to send email\n    const RESEND_API_KEY = process.env.RESEND_API_KEY;\n    \n    if (!RESEND_API_KEY) {\n      // Fallback: log the email (for development)\n      console.log('Contact form submission:', {\n        from: body.email,\n        to: 'brunoottonelli@gmail.com',\n        subject: body.subject,\n        message: body.message,\n      });\n      \n      return createSuccessResponse(\n        { message: 'Email logged (RESEND_API_KEY not configured)' },\n        200\n      );\n    }\n\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n      },\n      body: JSON.stringify({\n        from: 'Contact Form <onboarding@resend.dev>', // Update with your verified domain\n        to: 'brunoottonelli@gmail.com',\n        reply_to: body.email,\n        subject: body.subject,\n        html: `\n          <h2>New Contact Form Submission</h2>\n          <p><strong>From:</strong> ${body.email}</p>\n          <p><strong>Subject:</strong> ${body.subject}</p>\n          <hr>\n          <p><strong>Message:</strong></p>\n          <p>${body.message.replace(/\\n/g, '<br>')}</p>\n        `,\n        text: `\nNew Contact Form Submission\n\nFrom: ${body.email}\nSubject: ${body.subject}\n\nMessage:\n${body.message}\n        `,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.message || 'Failed to send email');\n    }\n\n    const data = await response.json();\n    return createSuccessResponse({ message: 'Email sent successfully', id: data.id }, 200);\n  } catch (error: any) {\n    console.error('Email sending error:', error);\n    return createErrorResponse({\n      errorMessage: error.message || 'Failed to send email',\n      status: 500,\n    });\n  }\n});\n\n"],"names":[],"mappings":";;;AACA;AACA;;;AAGO,MAAM,OAAO,CAAA,GAAA,4HAAA,CAAA,oBAAiB,AAAD,EAAE,OAAO;IAC3C,MAAM,OAAO,MAAM,CAAA,GAAA,4HAAA,CAAA,sBAAmB,AAAD,EAAE;IAEvC,2BAA2B;IAC3B,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,OAAO,IAAI,CAAC,KAAK,OAAO,EAAE;QACjD,OAAO,CAAA,GAAA,kIAAA,CAAA,sBAAmB,AAAD,EAAE;YACzB,cAAc;YACd,QAAQ;QACV;IACF;IAEA,wBAAwB;IACxB,MAAM,aAAa;IACnB,IAAI,CAAC,WAAW,IAAI,CAAC,KAAK,KAAK,GAAG;QAChC,OAAO,CAAA,GAAA,kIAAA,CAAA,sBAAmB,AAAD,EAAE;YACzB,cAAc;YACd,QAAQ;QACV;IACF;IAEA,IAAI;QACF,+BAA+B;QAC/B,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;QAEjD,IAAI,CAAC,gBAAgB;YACnB,4CAA4C;YAC5C,QAAQ,GAAG,CAAC,4BAA4B;gBACtC,MAAM,KAAK,KAAK;gBAChB,IAAI;gBACJ,SAAS,KAAK,OAAO;gBACrB,SAAS,KAAK,OAAO;YACvB;YAEA,OAAO,CAAA,GAAA,kIAAA,CAAA,wBAAqB,AAAD,EACzB;gBAAE,SAAS;YAA+C,GAC1D;QAEJ;QAEA,MAAM,WAAW,MAAM,MAAM,iCAAiC;YAC5D,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,iBAAiB,CAAC,OAAO,EAAE,gBAAgB;YAC7C;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,MAAM;gBACN,IAAI;gBACJ,UAAU,KAAK,KAAK;gBACpB,SAAS,KAAK,OAAO;gBACrB,MAAM,CAAC;;oCAEqB,EAAE,KAAK,KAAK,CAAC;uCACV,EAAE,KAAK,OAAO,CAAC;;;aAGzC,EAAE,KAAK,OAAO,CAAC,OAAO,CAAC,OAAO,QAAQ;QAC3C,CAAC;gBACD,MAAM,CAAC;;;MAGT,EAAE,KAAK,KAAK,CAAC;SACV,EAAE,KAAK,OAAO,CAAC;;;AAGxB,EAAE,KAAK,OAAO,CAAC;QACP,CAAC;YACH;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;YACjC,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;QACnC;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,CAAA,GAAA,kIAAA,CAAA,wBAAqB,AAAD,EAAE;YAAE,SAAS;YAA2B,IAAI,KAAK,EAAE;QAAC,GAAG;IACpF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,CAAA,GAAA,kIAAA,CAAA,sBAAmB,AAAD,EAAE;YACzB,cAAc,MAAM,OAAO,IAAI;YAC/B,QAAQ;QACV;IACF;AACF","debugId":null}}]
}